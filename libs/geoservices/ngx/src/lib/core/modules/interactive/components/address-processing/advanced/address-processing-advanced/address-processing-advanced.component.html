<div [@inOutAnimation]>
  <form [formGroup]="form" (submit)="processInteractiveQuery()">
    <div class="form-section">
      <div class="form-section-toolbar">
        <div class="form-section-name">
          <p>Input Address</p>
        </div>
      </div>

      <div class="form-section-body">
        <div class="form-collection row">
          <tamu-gisc-textbox [type]="'text'" [floatLabel]="true" [placeholder]="'Non-parsed Street Address (e.g 123 main street)'" formControlName="address"></tamu-gisc-textbox>
        </div>

        <div class="form-collection row">
          <tamu-gisc-textbox [type]="'text'" [floatLabel]="true" [placeholder]="'Non-parsed City (Optional)'" formControlName="city"></tamu-gisc-textbox>
        </div>

        <div class="form-collection row">
          <tamu-gisc-select [placeholder]="'State (Optional)'" [data]="states" [displayTemplate]="'name'" [valueTemplate]="'abbreviation'" formControlName="state"></tamu-gisc-select>
        </div>

        <div class="form-collection row">
          <tamu-gisc-textbox [type]="'number'" [floatLabel]="true" [placeholder]="'Non-parsed Zip (Optional)'" formControlName="zip"></tamu-gisc-textbox>
        </div>
      </div>
    </div>

    <div class="form-section">
      <div class="form-section-toolbar">
        <div class="form-section-name">
          <p>Address Formats</p>
        </div>
      </div>

      <div class="form-section-body">
        <div class="form-collection column">
          <p>Select all applicable return address formats. For an explanation of each and their differences, see the API <a [routerLink]="['/docs/address-processing']" target="_blank">documentation.</a></p>

          <tamu-gisc-checkbox-group formControlName="addressFormat" [referenceId]="'value'">
            <tamu-gisc-checkbox *ngFor="let format of formats" [label]="format.name" [data]="format"></tamu-gisc-checkbox>
          </tamu-gisc-checkbox-group>
        </div>

        <div class="form-collection row">
          <tamu-gisc-button [value]="buttonLanguage | async" [disabled]="form.invalid || (processing | async) === true" [type]="'submit'"></tamu-gisc-button>
        </div>
      </div>
    </div>
  </form>
</div>

<ng-container *ngIf="result | async as res">
  <div [@inOutAnimation] class="leader-3">
    <h2 class="section-header">Results</h2>

    <tamu-gisc-accordion [expanded]="true">
      <tamu-gisc-accordion-header>Transaction Details</tamu-gisc-accordion-header>
      <tamu-gisc-accordion-content>
        <table>
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>Time Taken</td>
              <td>{{res?.data?.timeTaken | number}}ms</td>
            </tr>

            <tr>
              <td>Transaction Guid</td>
              <td>{{res?.data?.transactionGuid}}</td>
            </tr>

            <tr>
              <td>Transaction Result</td>
              <td>{{res?.data?.queryStatusCode}}</td>
            </tr>
          </tbody>
        </table>
      </tamu-gisc-accordion-content>
    </tamu-gisc-accordion>

    <tamu-gisc-accordion *ngFor="let cr of (result | async)?.data?.results" [expanded]="true">
      <tamu-gisc-accordion-header>Result: {{cr?.parsedAddress?.addressFormatType}}</tamu-gisc-accordion-header>
      <tamu-gisc-accordion-content>
        <table>
          <thead>
            <tr>
              <th>Field</th>
              <th>Value</th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>Address Location Type</td>
              <td>{{cr?.parsedAddress?.addressLocationType}}</td>
            </tr>

            <tr>
              <td>Address Format Type</td>
              <td>{{cr?.parsedAddress?.addressFormatType}}</td>
            </tr>

            <tr>
              <td>Number</td>
              <td>{{cr?.parsedAddress?.number}}</td>
            </tr>

            <tr>
              <td>Number Fractional</td>
              <td>{{cr?.parsedAddress?.numberFractional}}</td>
            </tr>

            <tr>
              <td>Pre-Directional</td>
              <td>{{cr?.parsedAddress?.preDirectional}}</td>
            </tr>

            <tr>
              <td>Pre-Qualifier</td>
              <td>{{cr?.parsedAddress?.preQualifier}}</td>
            </tr>

            <tr>
              <td>Pre-Type</td>
              <td>{{cr?.parsedAddress?.preType}}</td>
            </tr>

            <tr>
              <td>Pre-Article</td>
              <td>{{cr?.parsedAddress?.preArticle}}</td>
            </tr>

            <tr>
              <td>Name</td>
              <td>{{cr?.parsedAddress?.name}}</td>
            </tr>

            <tr>
              <td>Post-Article</td>
              <td>{{cr?.parsedAddress?.postArticle}}</td>
            </tr>

            <tr>
              <td>Post-Qualifier</td>
              <td>{{cr?.parsedAddress?.postQualifier}}</td>
            </tr>

            <tr>
              <td>Post Directional</td>
              <td>{{cr?.parsedAddress?.postDirectional}}</td>
            </tr>

            <tr>
              <td>Suffix</td>
              <td>{{cr?.parsedAddress?.suffix}}</td>
            </tr>

            <tr>
              <td>Suite Type</td>
              <td>{{cr?.parsedAddress?.suiteType}}</td>
            </tr>

            <tr>
              <td>Suite Number</td>
              <td>{{cr?.parsedAddress?.suiteNumber}}</td>
            </tr>

            <tr>
              <td>City</td>
              <td>{{cr?.parsedAddress?.city}}</td>
            </tr>

            <tr>
              <td>Minor Civil Division</td>
              <td>{{cr?.parsedAddress?.minorCivilDivision}}</td>
            </tr>

            <tr>
              <td>Consolidated City</td>
              <td>{{cr?.parsedAddress?.consolidatedCity}}</td>
            </tr>

            <tr>
              <td>County Sub-Region</td>
              <td>{{cr?.parsedAddress?.countySubRegion}}</td>
            </tr>

            <tr>
              <td>County</td>
              <td>{{cr?.parsedAddress?.county}}</td>
            </tr>

            <tr>
              <td>State</td>
              <td>{{cr?.parsedAddress?.state}}</td>
            </tr>

            <tr>
              <td>Zip</td>
              <td>{{cr?.parsedAddress?.zip}}</td>
            </tr>

            <tr>
              <td>Zip+1</td>
              <td>{{cr?.parsedAddress?.zipPlus1}}</td>
            </tr>

            <tr>
              <td>Zip+2</td>
              <td>{{cr?.parsedAddress?.zipPlus2}}</td>
            </tr>

            <tr>
              <td>Zip+3</td>
              <td>{{cr?.parsedAddress?.zipPlus3}}</td>
            </tr>

            <tr>
              <td>Zip+4</td>
              <td>{{cr?.parsedAddress?.zipPlus4}}</td>
            </tr>

            <tr>
              <td>Zip+5</td>
              <td>{{cr?.parsedAddress?.zipPlus5}}</td>
            </tr>

            <tr>
              <td>Country</td>
              <td>{{cr?.parsedAddress?.country}}</td>
            </tr>
          </tbody>
        </table>
      </tamu-gisc-accordion-content>
    </tamu-gisc-accordion>
  </div>
</ng-container>

