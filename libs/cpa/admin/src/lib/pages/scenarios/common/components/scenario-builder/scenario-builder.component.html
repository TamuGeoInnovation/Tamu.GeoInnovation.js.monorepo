<form [formGroup]="builderForm" (ngSubmit)="createScenario()">
  <div class="form-section" *ngIf="isExisting | async">
    <div class="form-section-toolbar">
      <div class="form-section-name">
        <p>What workshop would you like to base this scenario on?</p>
      </div>
    </div>

    <div class="form-section-body">
      <div class="form-collection row">
        <tamu-gisc-select [data]="workshops | async" placeholder="Select a workshop" [displayTemplate]="'title'" (changed)="setWorkshopScenario($event)"></tamu-gisc-select>
      </div>

      <p *ngIf="(workshops | async)?.length === 0">Currently there are no workshops</p>
    </div>
  </div>

  <div class="form-section">
    <div class="form-section-toolbar">
      <div class="form-section-name">
        <p>General</p>
      </div>
    </div>

    <div class="form-section-body">
      <div class="form-collection row">
        <tamu-gisc-textbox formControlName="title" placeholder="Title" type="text" floatLabel="true"> </tamu-gisc-textbox>
      </div>

      <div class="form-collection row">
        <tamu-gisc-textbox formControlName="description" placeholder="Description" type="textarea" floatLabel="true" rows="8"></tamu-gisc-textbox>
      </div>
    </div>
  </div>

  <div class="map-configuration-container" *ngIf="responses">
    <div class="map-configuration">
      <div class="form-section">
        <div class="form-section-toolbar">
          <div class="form-section-name">
            <p>Map Properties</p>
          </div>
        </div>

        <div class="form-section-body">
          <div class="form-collection row">
            <tamu-gisc-textbox formControlName="mapCenter" placeholder="Map Center" type="text" floatLabel="true">
              <div class="textbox-actions material-icons-container">
                <span class="material-icons action alt" title="Set Current Center" (click)="setMapCenter()">crop</span>
              </div>
            </tamu-gisc-textbox>

            <tamu-gisc-textbox formControlName="zoom" placeholder="Map Zoom" type="number" floatLabel="true">
              <div class="textbox-actions material-icons-container">
                <span class="material-icons action alt" title="Set Current Zoom" (click)="setMapZoom()">search</span>
              </div>
            </tamu-gisc-textbox>
          </div>
        </div>
      </div>

      <div class="form-section" *ngIf="this.selectedWorkshop">
        <div class="form-section-toolbar">
          <div class="form-section-name">
            <p>Layers</p>
          </div>
        </div>

        <tamu-gisc-checkbox-group id="response-list" class="form-section-body" formControlName="layerGuids" [referenceId]="'guid'">
          <tamu-gisc-checkbox *ngFor="let response of (responses | async)" (mouseover)="loadPreviewResponseLayer(response)" (mouseleave)="clearPreviewLayer()" [label]="response.name + ' ' +'(' + response.snapshot.title + ')'" [data]="response"></tamu-gisc-checkbox>
        </tamu-gisc-checkbox-group>

        <p *ngIf="(responses | async)?.length === 0">There are no responses for this workshop.</p>
      </div>
    </div>

    <div class="map-preview">
      <div class="form-section">
        <div class="form-section-toolbar">
          <div class="form-section-name">
            <p>Preview</p>
          </div>
        </div>

        <div class="form-section-body">
          <div class="form-collection row">
            <tamu-gisc-esri-map [config]="config"></tamu-gisc-esri-map>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="form-collection row">
    <ng-container *ngIf="(isExisting | async) === false">
      <tamu-gisc-button type="submit" value="Publish" [disabled]="!builderForm.valid"></tamu-gisc-button>
    </ng-container>

    <ng-container *ngIf="isExisting | async">
      <tamu-gisc-button type="submit" value="Update" [disabled]="!builderForm.valid"></tamu-gisc-button>
    </ng-container>
  </div>
</form>
