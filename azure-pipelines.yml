# pool:
#   vmImage: 'windows-latest'

pool:
  name: 'default'

# variables:
#   npm_config_cache: $(Pipeline.Workspace)/.npm

jobs:
  - job: UESRecyclingCI  
    steps:
      - checkout: self
        clean: false
        fetchDepth: 1 # Fetch only one commit

      - task: NodeTool@0
        inputs:
          versionSpec: '12.18'
        displayName: 'Install Node.js'

      - script: npm i
        displayName: 'Clean dependencies'

      - script: |
          npx nx run ues-recycling-angular:build --prod --baseHref /recycling/
        displayName: 'Build ues-recycling-angular'

      - task: CopyFiles@2
        inputs:
          Contents: 'dist/**'
          TargetFolder: '$(Build.ArtifactStagingDirectory)'
        displayName: 'Copy Distribution Files'

      - task: PublishBuildArtifacts@1
        inputs:
          pathtoPublish: $(Build.ArtifactStagingDirectory) # dist or build files
          ArtifactName: 'js-monorepo' # output artifact named www
        displayName: 'Publish Artifacts'
        
